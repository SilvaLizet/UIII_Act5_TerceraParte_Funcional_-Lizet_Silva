{% extends 'base.html' %}

{% block title %}Detalle Cliente{% endblock %}

{% block content %}
<h2 class="mb-4 text-success">Detalles del Cliente: {{ cliente.nombre }} {{ cliente.apellido }}</h2>
<div class="card p-4 border-success shadow-sm">
    <div class="card-body">
        <p class="card-text"><strong>ID:</strong> {{ cliente.id }}</p>
        <p class="card-text"><strong>Nombre:</strong> {{ cliente.nombre }}</p>
        <p class="card-text"><strong>Apellido:</strong> {{ cliente.apellido }}</p>
        <p class="card-text"><strong>Teléfono:</strong> {{ cliente.telefono }}</p>
        <p class="card-text"><strong>Email:</strong> {{ cliente.email }}</p>
        <p class="card-text"><strong>Dirección:</strong> {{ cliente.direccion }}</p>
        <p class="card-text"><strong>Ciudad:</strong> {{ cliente.ciudad }}</p>
        <p class="card-text"><strong>Código Postal:</strong> {{ cliente.codigo_postal }}</p>

        <h4 class="mt-4 text-success">Contratos de Servicio de este Cliente</h4>
        {% if contratos_cliente %}
            <ul class="list-group">
                {% for contrato in contratos_cliente %}
                    <li class="list-group-item">
                        Contrato #{{ contrato.id }} - Servicio: <strong>{{ contrato.servicio.nombre_servicio }}</strong>
                        (Programado para: {{ contrato.fecha_programada|date:"d/m/Y" }}) - Estado: {{ contrato.get_estado_display }}
                        <br>
                        Empleados asignados: 
                        {% for empleado in contrato.empleados.all %}
                            {{ empleado.nombre }} {{ empleado.apellido }}{% if not forloop.last %}, {% endif %}
                        {% empty %}
                            Ninguno
                        {% endfor %}
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Este cliente no tiene contratos de servicio registrados.</p>
        {% endif %}

        <div class="mt-4">
            <a href="{% url 'actualizar_cliente' cliente.id %}" class="btn btn-warning me-2"><i class="fas fa-edit me-2"></i>Editar Cliente</a>
            <a href="{% url 'ver_clientes' %}" class="btn btn-secondary"><i class="fas fa-arrow-left me-2"></i>Volver a Clientes</a>
        </div>
    </div>
</div>
{% endblock %}