{% extends 'base.html' %}

{% block title %}Agregar Contrato{% endblock %}

{% block content %}
<h2 class="mb-4 text-success">Crear Nuevo Contrato de Servicio</h2>
<form method="post" class="p-4 border rounded shadow-sm bg-white">
    {% csrf_token %}
    <div class="mb-3">
        <label for="cliente" class="form-label">Cliente</label>
        <select class="form-select" id="cliente" name="cliente" required>
            <option value="">Selecciona un cliente...</option>
            {% for cliente in clientes %}
                <option value="{{ cliente.id }}">{{ cliente.nombre }} {{ cliente.apellido }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="mb-3">
        <label for="servicio" class="form-label">Servicio</label>
        <select class="form-select" id="servicio" name="servicio" required>
            <option value="">Selecciona un servicio...</option>
            {% for servicio in servicios %}
                <option value="{{ servicio.id }}">{{ servicio.nombre_servicio }} - ${{ servicio.precio|floatformat:2 }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="mb-3">
        <label for="empleados" class="form-label">Empleados Asignados (Selecciona uno o más con Ctrl/Cmd)</label>
        <select multiple class="form-select" id="empleados" name="empleados">
            {% for empleado in empleados %}
                <option value="{{ empleado.id }}">{{ empleado.nombre }} {{ empleado.apellido }} ({{ empleado.puesto }})</option>
            {% endfor %}
        </select>
        <small class="form-text text-muted">Mantén 'Ctrl' (Windows) o 'Cmd' (Mac) para seleccionar múltiples empleados.</small>
    </div>
    <div class="mb-3">
        <label for="fecha_programada" class="form-label">Fecha Programada</label>
        <input type="date" class="form-control" id="fecha_programada" name="fecha_programada" required>
    </div>
    <div class="mb-3">
        <label for="estado" class="form-label">Estado del Contrato</label>
        <select class="form-select" id="estado" name="estado" required>
            <option value="PENDIENTE">Pendiente</option>
            <option value="EN_PROGRESO">En Progreso</option>
            <option value="COMPLETADO">Completado</option>
            <option value="CANCELADO">Cancelado</option>
        </select>
    </div>
    <div class="mb-3">
        <label for="observaciones" class="form-label">Observaciones</label>
        <textarea class="form-control" id="observaciones" name="observaciones" rows="3"></textarea>
    </div>
    <div class="mb-3">
        <label for="costo_total" class="form-label">Costo Total (opcional)</label>
        <input type="number" step="0.01" class="form-control" id="costo_total" name="costo_total">
    </div>
    <button type="submit" class="btn btn-success me-2"><i class="fas fa-save me-2"></i>Crear Contrato</button>
    <a href="{% url 'ver_contratos' %}" class="btn btn-secondary"><i class="fas fa-arrow-left me-2"></i>Cancelar</a>
</form>
{% endblock %}